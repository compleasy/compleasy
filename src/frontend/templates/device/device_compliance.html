<div class="bg-white shadow-md rounded-lg overflow-hidden p-6 mb-4">
    <h3 class="text-xl font-semibold mb-4">Compliance</h3>
    <div class="mb-6">
        <h4 class="text-lg font-medium mb-2">Policy Rulesets</h4>
        <table class="min-w-full">
            <thead>
                <tr class="bg-gray-200 text-gray-600 uppercase text-sm leading-normal">
                    <th class="w-4 py-3 px-2 text-left"></th>
                    <th class="w-64 py-3 px-6 text-left">Rule</th>
                    <th class="py-3 px-6 text-left">Description</th>
                    <th class="min-w-10 max-w-12 py-3 px-6 text-center">Policy status</th>
                    <!-- Action buttons -->
                    <th class="py-3 px-6 text-center">Action</th>
                </tr>
            </thead>
            <tbody class="text-gray-600 text-sm font-light">

                {% for ruleset in evaluated_rulesets %}
                <tr id="ruleset-{{ ruleset.id }}" data-ruleset-id="{{ ruleset.id }}" class="evaluated-ruleset border-b border-gray-200 hover:bg-gray-100">
                    <td class="py-3 px-6 justify-center">
                        <span class="cursor-pointer" onclick="toggleRules(this)">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4 hover:text-gray-900">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
                            </svg>
                        </span>
                    </td>
                    <td class="py-3 px-6 text-left"><span>{{ ruleset.name }}</span></td>
                    <td class="w-1/2 py-3 px-6 text-left"><span">{{ ruleset.description }}</span></td>
                    <td class="py-3 px-6 justify-center">
                        {% if ruleset.compliant %}
                        <!-- Green check -->
                         <span class="fill-current text-green-600" title="Compliant">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mx-auto">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75m-3-7.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.749c0 5.592 3.824 10.29 9 11.623 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.571-.598-3.751h-.152c-3.196 0-6.1-1.248-8.25-3.285Z" />
                            </svg>
                              
                                 
                          </span>                                 
                            
                        {% else %}
                        <span class="fill-current text-red-600" title="Non-Compliant">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mx-auto">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m0-10.036A11.959 11.959 0 0 1 3.598 6 11.99 11.99 0 0 0 3 9.75c0 5.592 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.31-.21-2.57-.598-3.75h-.152c-3.196 0-6.1-1.25-8.25-3.286Zm0 13.036h.008v.008H12v-.008Z" />
                              </svg>                                               
                          </span>   
                        {% endif %}
                    </td>
                    <!-- Buttons to Unassign policy ruleset to the device, or Edit the ruleset -->
                    <td class="py-3 px-6 text-center">
                        <div class="flex justify-center space-x-2">
                            <a href="#" class="text-gray-600 hover:text-gray-900">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                                </svg>
                                
                            </a>
                        </div> 
                </tr>

                <!-- Rules hidden -->
                {% for rule in ruleset.rules %}
                <tr id="rule-{{ rule.id }}" data-rule-id="{{ rule.id }}" data-ruleset-id="{{ ruleset.id }}" class="evaluated-rule hidden-rule hidden border-b border-gray-200 hover:bg-gray-100">
                    <td class="w-4 py-3 px-6"></td>
                    <td class="py-3 px-6 text-left">
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-4">
                                <path stroke-linecap="round" stroke-linejoin="round" d="M5 12h14" />
                            </svg>        
                        <span>{{ rule.name }}</span>
                        </div>
                    </td>
                    <td class="py-3 px-6 text-left">{{ rule.description }}</td>
                    <td class="py-3 px-6 justify-center">
                        {% if rule.compliant %}
                            {% if rule.enabled %}
                            <!-- Enabled Pass: Green check -->
                            <span class="fill-current text-green-600" title="Pass">
                            {% else %}
                            <!-- Disabled Pass: Gray check -->
                            <span class="fill-current text-gray-600" title="Pass (disabled)">
                            {% endif %}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mx-auto">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m4.5 12.75 6 6 9-13.5" />
                                </svg>                                               
                            </span>  
                        {% else %}
                            {% if rule.enabled %}
                            <!-- Enabled Fail: Red X -->
                            <span class="fill-current text-red-600" title="Fail">
                            {% else %}
                            <!-- Disabled Fail: Gray X -->
                            <span class="fill-current text-gray-600" title="Fail (disabled)">
                            {% endif %}
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6 mx-auto">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M6 18 18 6M6 6l12 12" />
                                </svg>                                                                                         
                            </span>
                        {% endif %}
                    </td>
                    <td class="py-3 px-6 text-center">
                        <div class="flex justify-center space-x-2">
                            <a href="#" class="text-gray-600 hover:text-gray-900">
                                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10" />
                                </svg>
                                
                            </a>
                        </div>
                    </td>
                {% endfor %}

                {% empty %}

                <tr class="border-b border-gray-200 hover:bg-gray-100">
                    <td class="py-3 px-6 text-center" colspan="5">
                        <span class="block">No rulesets assigned.</span>
                        <span class="block">You can assign rulesets to this device by clicking the <span class="font-medium italic">Select rulesets</span> button below or going to the <span class="font-medium italic">Policy > Rulesets</span> section in the top menu.</span>
                    </td>
                </tr>

                {% endfor %}
        </table>
    </div>
    <!-- Buttons to assign or unassign ruleset to the device -->
    <div class="text-right">
        <button type="button" id="button-ruleset-selection-panel" class="button-ruleset-selection-panel bg-gray-200 hover:bg-gray-300 text-gray-800 py-2 px-4 rounded inline-flex items-center">
            <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>                          
            <span class="ml-2">Select rulesets</span>
        </button>
    </div>
    

</div>